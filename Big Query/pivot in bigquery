select orderNum,min(Order_Date) as First_date,sum(Item_Count) as Items_count,
sum(case when category = "Additif" then Revenue else 0 end) as Additif_Revenue,
sum(case when category = "Aliment" then Revenue else 0 end) as Aliment_Revenue,
sum(case when category = "Matériel" then Revenue else 0 end) as Materiel_Revenue,
sum(case when category = "Formulaire" then Revenue else 0 end) as Formulaire_Revenue,
sum(case when category = "Instrument" then Revenue else 0 end) as Instrument_Revenue,
sum(case when category = "Médicament" then Revenue else 0 end) as Medicament_Revenue,
sum(case when category = "Antiparasitaires PA" then Revenue else 0 end) as Antiparasitaires_PA_Revenue,
sum(case when category = "Equipement" then Revenue else 0 end) as Equipement_Revenue,
sum(case when category = "Biologique" then Revenue else 0 end) as Biologique_Revenue,
sum(case when category = "Additif" then Profit else 0 end) as Additif_Profit,
sum(case when category = "Aliment" then Profit else 0 end) as Aliment_Profit,
sum(case when category = "Matériel" then Profit else 0 end) as Materiel_Profit,
sum(case when category = "Formulaire" then Profit else 0 end) as Formulaire_Profit,
sum(case when category = "Instrument" then Profit else 0 end) as Instrument_Profit,
sum(case when category = "Médicament" then Profit else 0 end) as Medicament_Profit,
sum(case when category = "Antiparasitaires PA" then Profit else 0 end) as Antiparasitaires_PA_Profit,
sum(case when category = "Equipement" then Profit else 0 end) as Equipement_Profit,
sum(case when category = "Biologique" then Profit else 0 end) as Biologique_Profit from (
select orderNum, min(dateShipped) as Order_Date, count(itemNum) as Item_Count,
sum(sellPrice * qty) as Revenue,
sum(sellPrice * qty) - sum(costPrice * qty) as Profit,
category from `sandbox-211511.LIDD_Dataset.transactions6Mil` 
group by category,orderNum order by orderNum)
group by orderNum order by orderNum
